# Story 2.1: Notebook and Page Management System

## Status
Draft

## Story
As a user,
I want to create and organize notebooks with hierarchical pages in a three-column interface,
so that I can structure my notes in a logical, organized manner with intuitive navigation.

## Design Reference
**Figma Design:** [Notebook and Page Management UI](https://www.figma.com/design/J4Dsi0o3FCgCgqrvPCAehY/Untitled?node-id=0-1&p=f&t=IQnLuDhX4ei3mhjS-0)

**Key Design Elements:**
- Three-column layout: Notebooks (left), Notes (middle), Note Detail (right)
- Clean, minimalist design with white background and grey text
- Yellow accent color for selected items and action buttons
- Navigation icons on far left: document/page, people, disk/save
- Search functionality with "Q Search notes" placeholder
- Grid/list view toggle for notes display
- Rich text editor toolbar at bottom of detail view
- Pin/unpin functionality for notebooks and notes

## Acceptance Criteria
1. Create notebook creation and deletion functionality
2. Implement hierarchical page structure within notebooks
3. Add drag-and-drop page reordering within notebooks
4. Create page creation, editing, and deletion functionality
5. Implement infinite nested sub-pages support
6. Add notebook and page renaming capabilities
7. Create visual hierarchy display with indentation and icons
8. Implement quick page navigation with search
9. Add notebook and page metadata (creation date, last modified)
10. Store notebook and page structure in Firestore
11. **NEW:** Implement three-column layout matching Figma design
12. **NEW:** Add navigation sidebar with document, people, and save icons
13. **NEW:** Implement pin/unpin functionality for notebooks and notes
14. **NEW:** Add grid/list view toggle for notes display
15. **NEW:** Create search bar with "Q Search notes" placeholder
16. **NEW:** Implement yellow accent color for selected items and action buttons
17. **NEW:** Add rich text editor toolbar at bottom of detail view
18. **NEW:** Implement "New Notebook" modal dialog matching Figma design
19. **NEW:** Add notebook creation form with name and description fields
20. **NEW:** Implement form validation and submission handling
21. **NEW:** Add success feedback and navigation after notebook creation

## Tasks / Subtasks
- [ ] Three-column layout implementation (AC: 11)
  - [ ] Create main layout component with three responsive columns
  - [ ] Implement column resizing and responsive breakpoints
  - [ ] Add proper spacing and visual separation between columns
  - [ ] Ensure accessibility with proper ARIA landmarks
- [ ] Navigation sidebar (AC: 12)
  - [ ] Create left navigation with document, people, and save icons
  - [ ] Implement icon selection states and hover effects
  - [ ] Add keyboard navigation support
  - [ ] Wire navigation to appropriate app sections
- [ ] Notebooks column (AC: 1, 6, 9, 10, 13)
  - [ ] Data model for `Notebook` (id, name, description, metadata, pinned)
  - [ ] Create, rename, delete notebook operations
  - [ ] Implement pin/unpin functionality with visual indicators
  - [ ] Display notebook list with descriptions and last updated times
  - [ ] Persist notebook metadata (createdAt, updatedAt, pinned) in Firestore
- [ ] Notes column (AC: 2, 4, 5, 6, 8, 9, 13, 14, 15)
  - [ ] Data model for `Page` with parentId for hierarchy
  - [ ] Create, rename, delete page operations with pin/unpin support
  - [ ] Implement search bar with "Q Search notes" placeholder
  - [ ] Add grid/list view toggle with proper icon states
  - [ ] Display notes with titles, descriptions, and last updated times
  - [ ] Implement search functionality across current notebook pages
  - [ ] Fuzzy match and highlight search results
- [ ] Page tree with infinite nesting (AC: 2, 5, 10)
  - [ ] Firestore structure for nested pages (collection/field strategy)
  - [ ] Create read/write APIs for hierarchical retrieval
  - [ ] Implement expand/collapse for nested page structure
- [ ] Drag-and-drop reordering (AC: 3)
  - [ ] Implement DnD in page tree with keyboard-accessible reorder
  - [ ] Update ordering/index fields and parent changes in Firestore
  - [ ] Handle cross-level moves and constraints
- [ ] Note detail view (AC: 4, 6, 9, 17)
  - [ ] Create detailed note view in right column
  - [ ] Display note title, last updated time, and full content
  - [ ] Implement rich text editor toolbar at bottom
  - [ ] Add toolbar with formatting options (bold, italic, underline, alignment, lists, etc.)
  - [ ] Wire toolbar actions to rich text editor functionality
- [ ] Visual design implementation (AC: 7, 16)
  - [ ] Implement clean, minimalist design with white background
  - [ ] Add yellow accent color for selected items and action buttons
  - [ ] Create proper hover and focus states
  - [ ] Implement visual hierarchy with indentation and icons
  - [ ] Performance optimization for large trees (virtualization where needed)
- [ ] Firestore integration (AC: 10)
  - [ ] Define converters/types and validation
  - [ ] Real-time listeners for notebooks and pages
  - [ ] Error handling, retry, and empty/loading states
- [ ] **NEW:** "New Notebook" modal implementation (AC: 18, 19, 20, 21)
  - [ ] Create modal with title "New Notebook" and close button
  - [ ] Add "Name" input field with placeholder "e.g., Marketing Campaign Q3"
  - [ ] Add "Description (optional)" textarea with placeholder "e.g., A place for all assets and notes for the upcoming campaign."
  - [ ] Implement "Cancel" and "Create Notebook" buttons (yellow primary button)
  - [ ] Add form validation for required name field
  - [ ] Implement form submission with Firestore integration
  - [ ] Add success feedback and modal close on successful creation
  - [ ] Handle error states and user-friendly error messages

## Dev Notes
- Align data models and Firestore structure with Epic 2 and Firestore best practices.
- Consider batched writes and transactions for reorder/move operations.
- Ensure accessibility: keyboard DnD alternatives, ARIA tree patterns.
- **Design Implementation Notes:**
  - Follow the three-column layout from Figma design: Notebooks (left), Notes (middle), Note Detail (right)
  - Use Material UI components with custom theming to match the clean, minimalist design
  - Implement yellow accent color (#FFD700 or similar) for selected items and action buttons
  - Navigation sidebar should be fixed width with proper icon spacing
  - Search functionality should be prominently placed in the Notes column header
  - Grid/list toggle should be positioned next to the search bar
  - Rich text editor toolbar should be fixed at the bottom of the detail view
  - Pin/unpin functionality should use appropriate icons and visual feedback

### Testing
- Unit tests: data model helpers and Firestore API wrappers.
- Component tests: tree renders hierarchy, expand/collapse, rename inline edit.
- Interaction tests: drag-and-drop reorders and persists changes.
- Integration tests: create notebook/page and see real-time updates.
- **UI/UX Testing:**
  - Test three-column layout responsiveness across different screen sizes
  - Verify navigation sidebar functionality and icon states
  - Test search functionality with various input scenarios
  - Validate grid/list view toggle behavior
  - Test pin/unpin functionality with visual feedback
  - Verify yellow accent color application for selected items
  - Test rich text editor toolbar functionality

## Change Log
| Date | Version | Description | Author |
| ---- | ------- | ----------- | ------ |
| 2024-12-18 | 0.1 | Initial draft created from PRD Epic 2 Story 2.1 | Scrum Master |
| 2024-12-24 | 0.2 | Updated with Figma design reference and three-column layout requirements | Scrum Master |
| 2025-01-27 | 0.3 | Added "New Notebook" modal dialog implementation with form validation | Product Owner |


